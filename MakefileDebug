KPDir = /usr/lib/keepass2
KPPDir = $(KPDir)/Plugins

all: bin/Debug/KeePassFaviconDownloader.dll

bin/KeePassFaviconDownloader.dll: KeePassFaviconDownloader.sln \
								  src/KeePassFaviconDownloader.csproj \
								  src/KeePassFaviconDownloaderExt.cs \
								  src/Properties/AssemblyInfo.cs \
								  src/HtmlAgilityPack.dll
	xbuild /p:Configuration=Debug /p:IntermediateOutputPath="../build/" /p:OutputPath="../bin/" KeePassFaviconDownloader.sln /p:TargetFrameworkVersion="v4.5"

install: bin/KeePassFaviconDownloader.dll
	\mkdir -p "$(DESTDIR)$(KPPDir)"
	\cp "bin/KeePassFaviconDownloader.dll" "$(DESTDIR)$(KPPDir)/KeePassFaviconDownloader.dll"
	\cp "bin/HtmlAgilityPack.dll" "$(DESTDIR)$(KPPDir)/HtmlAgilityPack.dll"

clean:
	\rm -rf build bin

distclean: clean

uninstall:
	\rm -f "$(DESTDIR)$(KPPDir)/KeePassFaviconDownloader.dll"
	\rm -f "$(DESTDIR)$(KPPDir)/HtmlAgilityPack.dll"

.PHONY: all install clean distclean uninstall
